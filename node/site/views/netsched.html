<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
<title> Main app </title>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
	<script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
    <script type="text/javascript">
		$(document).ready(function() {		
	        $.ajax({
	            url: "/networks",
	            data: "format=json",
	            json: "jsoncallback",
	            dataType: "json",
	            success: function(data)
	            {									
					$("#networkTemplate").tmpl(data).appendTo("#ddlNetwork");
	            }
	        });
	
			$("#ddlNetwork").bind('change', function() {
				clearSchedule();
				getScheduleByNetwork($(this).val())
			 });
	    });
	
		function getScheduleByNetwork(network)
		{
        	$.ajax({
            	url: "/schedules/network/" + network + "/today",
            	data: "format=json",
            	json: "jsoncallback",
            	dataType: "json",
            	success: function(data)
            	{									
                	$("#dayTemplate").tmpl(data).appendTo("#ulSchedule");
            	}
        	});		
		}
		
		function clearSchedule()
		{
			$("#ulSchedule").children().remove();
		}	
    </script>
	<script id="dayTemplate" type="text/x-jquery-tmpl">
	    <li>
	        <span>${Title.Name} - ${StartDate} to ${EndDate}</span>
	    </li>
	</script>
	<script id="networkTemplate" type="text/x-jquery-tmpl">
	    <option value=${Code}>${Name}</option>
	</script>	
</head>
<body>
<select id="ddlNetwork"></select>	
<ul id="ulSchedule"></ul>
</body>
</html>